["{\"nodes\":{\"Compute_LatestOpportunity_byAccount\":{\"action\":\"computeRelative\",\"parameters\":{\"computedFields\":[{\"expression\":{\"offset\":\"first()\",\"sourceField\":\"Id\"},\"label\":\"LatestOpportunityIDbyEffectiveDate\",\"name\":\"LatestOpportunityIDbyEffectiveDate\"}],\"orderBy\":[{\"direction\":\"desc\",\"name\":\"Effective_Date__c\"}],\"partitionBy\":[\"AccountId\"]},\"sources\":[\"Augment_Opportunity_withOpportunityPartner\"]},\"Compute_AccountContracts\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"0\",\"label\":\"Contracts\",\"name\":\"Contracts\",\"precision\":7,\"saqlExpression\":\"case \\nwhen ('Latest_Medical_Enrollment__c'+'Latest_Drug_Enrollment__c'+'Latest_Dental_Enrollment__c'+'Latest_Vision_Enrollment__c')==0 && 'LatestOpportunity.Potential_Contracts__c' >0 then 'LatestOpportunity.Potential_Contracts__c'\\nwhen ('Latest_Medical_Enrollment__c'+'Latest_Drug_Enrollment__c'+'Latest_Dental_Enrollment__c'+'Latest_Vision_Enrollment__c')==0 && 'NumberOfEmployees' >0 then 'NumberOfEmployees'\\nwhen ('Latest_Medical_Enrollment__c'>='Latest_Drug_Enrollment__c') && ('Latest_Medical_Enrollment__c'>='Latest_Dental_Enrollment__c') && ('Latest_Medical_Enrollment__c'>='Latest_Vision_Enrollment__c') then 'Latest_Medical_Enrollment__c'\\nwhen ('Latest_Drug_Enrollment__c'>='Latest_Medical_Enrollment__c') && ('Latest_Drug_Enrollment__c'>='Latest_Dental_Enrollment__c') && ('Latest_Drug_Enrollment__c'>='Latest_Vision_Enrollment__c') then 'Latest_Drug_Enrollment__c'\\nwhen ('Latest_Dental_Enrollment__c'>='Latest_Medical_Enrollment__c') && ('Latest_Dental_Enrollment__c'>='Latest_Drug_Enrollment__c') && ('Latest_Dental_Enrollment__c'>='Latest_Vision_Enrollment__c') then 'Latest_Dental_Enrollment__c'\\nwhen ('Latest_Vision_Enrollment__c'>='Latest_Medical_Enrollment__c') && ('Latest_Vision_Enrollment__c'>='Latest_Drug_Enrollment__c') && ('Latest_Vision_Enrollment__c'>='Latest_Dental_Enrollment__c') then 'Latest_Vision_Enrollment__c'\\nelse 0\\nend\",\"scale\":0,\"type\":\"Numeric\"}],\"mergeWithSource\":true},\"sources\":[\"Augment_Account_withLatestOpportunity\"]},\"Filter_Account\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"RecordType.Name:EQ:51+,Type:EQ:Prospect|Customer\"},\"sources\":[\"Augment_Account_withRecordType\"]},\"Augment_Account_withRecordType\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RecordTypeId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"RecordType\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"DeveloperName\",\"Name\"]},\"sources\":[\"Extract_Accountone\",\"Extract_RecordType\"]},\"Augment_Account_withLatestOpportunity\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"LatestOpportunity\",\"rightKey\":[\"AccountId\"],\"rightSelect\":[\"Id\",\"CreatedDate\",\"Effective_Date__c\",\"Potential_Contracts__c\",\"Won_Lost_Reason__c\",\"IsWon\",\"Incumbent_Successor__c\",\"Lead_Rep_Name_User__c\",\"Lead_Rep_Number_User__c\",\"Lead_Rep_Name__c\",\"RecordType.Name\",\"AccountId\",\"OpportunityPartner.IsPrimary\",\"OpportunityPartner.AccountToId\",\"OpportunityPartner.Partner.Name\",\"Market_Segment_New__c\"]},\"sources\":[\"Filter_Account\",\"Filter_Opportunity_LatestOnly\"]},\"Extract_Opportunity\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"AccountId\"},{\"name\":\"Id\"},{\"name\":\"RecordTypeId\"},{\"name\":\"CreatedDate\"},{\"name\":\"Effective_Date__c\"},{\"name\":\"Potential_Contracts__c\"},{\"name\":\"Won_Lost_Reason__c\"},{\"name\":\"IsWon\"},{\"name\":\"Incumbent_Successor__c\"},{\"name\":\"Lead_Rep_Name_User__c\"},{\"name\":\"Lead_Rep_Number_User__c\"},{\"name\":\"Lead_Rep_Name__c\"},{\"name\":\"Market_Segment_New__c\"}],\"object\":\"Opportunity\"}},\"Register_fiftyoneplusAccounts\":{\"action\":\"register\",\"parameters\":{\"label\":\"Accounts fiftyoneplus\",\"name\":\"Accounts51Plus\"},\"sources\":[\"Augment_Account_withZipcode\"]},\"Compute_Opportunity_isLatestOpportunity\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"defaultValue\":\"\\\"FALSE\\\"\",\"label\":\"isLatestOpportunity\",\"name\":\"isLatestOpportunity\",\"saqlExpression\":\"case\\nwhen 'Id' == 'LatestOpportunityIDbyEffectiveDate' then \\\"TRUE\\\"\\nelse \\\"FALSE\\\"\\nend\\n\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_LatestOpportunity_byAccount\"]},\"Augment_Opportunity_withRecordType\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"RecordTypeId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"RecordType\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"DeveloperName\",\"Name\"]},\"sources\":[\"Extract_Opportunity\",\"Extract_RecordType\"]},\"Augment_Account_withZipcode\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"BillingPostalCode\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Zipcode\",\"rightKey\":[\"ZIPCode\"],\"rightSelect\":[\"County\",\"Region\"]},\"sources\":[\"Augment_Account_withSICIndustry\",\"Extract_Zipcode\"]},\"Augment_Opportunity_withOpportunityPartner\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Id\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"OpportunityPartner\",\"rightKey\":[\"OpportunityId\"],\"rightSelect\":[\"IsPrimary\",\"Partner.Name\",\"AccountToId\"]},\"sources\":[\"Filter_Opportunity\",\"Augment_OpportunityPartner_withAccount\"]},\"Augment_Account_withSICIndustry\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"Sic\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Industry\",\"rightKey\":[\"SIC_Code\"],\"rightSelect\":[\"SIC_Converted_to_2_Digit\",\"X1_Digit_SIC\",\"X2_Digit_SIC\"]},\"sources\":[\"Compute_AccountContracts\",\"Extract_SICIndustry\"]},\"Extract_SICIndustry\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"SIC_Industry\"}},\"Filter_Opportunity_LatestOnly\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"isLatestOpportunity:EQ:TRUE\"},\"sources\":[\"Compute_Opportunity_isLatestOpportunity\"]},\"Extract_Accountone\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Name\"},{\"name\":\"Id\"},{\"name\":\"Type\"},{\"name\":\"RecordTypeId\"},{\"name\":\"Sic\"},{\"name\":\"BillingPostalCode\"},{\"name\":\"NumberOfEmployees\"},{\"name\":\"Latest_Dental_Enrollment__c\"},{\"name\":\"Latest_Drug_Enrollment__c\"},{\"name\":\"Latest_Medical_Enrollment__c\"},{\"name\":\"Latest_Vision_Enrollment__c\"}],\"object\":\"Account\"}},\"Extract_RecordType\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Name\"},{\"name\":\"DeveloperName\"}],\"object\":\"RecordType\"}},\"Extract_Zipcode\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"Zipcode\"}},\"Filter_Opportunity\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"RecordType.Name:EQ:51+|200+\"},\"sources\":[\"Augment_Opportunity_withRecordType\"]},\"Augment_OpportunityPartner_withAccount\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"AccountToId\"],\"operation\":\"LookupSingleValue\",\"relationship\":\"Partner\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Name\"]},\"sources\":[\"Extract_OpportunityPartner\",\"Extract_Accountone\"]},\"Extract_OpportunityPartner\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"OpportunityId\"},{\"name\":\"IsPrimary\"},{\"name\":\"AccountToId\"},{\"name\":\"Id\"}],\"object\":\"OpportunityPartner\"}}}}",null]